
// ุฎุฏูุฉ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุงููุญููุฉ (ุจุฏูู API Key)
// Local Simulation Service

// ููุงุนุฏ ุจูุงูุงุช ุงูุฑุฏูุฏ ุงูุฐููุฉ - ุงูุฅุตุฏุงุฑ ุงูุฃุณุทูุฑู
const RESPONSES_DB: Record<string, string[]> = {
  food: [
    'ุดููู ูุดูู! ๐', 'ุจุงูุนุงููุฉ ุนูููู ๐ฅ', 'ุฌูุนุชูู ุจูุฐุง ุงูููุดูุฑ! ๐ฉ', 'ูู ูุฐูู ูู ุงูุชูุฏูู ๐', 
    'ุฃุญุชุงุฌ ุงููุตูุฉ ุถุฑูุฑู! ๐', 'ูุง ุดุงุก ุงููู ุชุจุงุฑู ุงููู โจ', 'ุงูุนุฒููุฉ ุงูุฌุงูุฉ ุนูุฏู ๐', 'ุทุนู ูุง ููุงูู ุฃููุฏ ๐'
  ],
  tech: [
    'ุชุทูุฑ ุฑููุจ ๐', 'ุงูุชูููุฉ ุชุชุทูุฑ ุจุณุฑุนุฉ ุฎูุงููุฉ ๐คฏ', 'ูุฑุงุฌุนุฉ ููุชุงุฒุฉ ููููุฏุฉ', 'ูู ุชูุตุญ ุจุดุฑุงุฆูุ ๐ค',
    'ุชุตููู ุงูุฌูุงุฒ ูุฎู ุฌุฏุงู โจ', 'ุงูููุงุตูุงุช ุฌุจุงุฑุฉ ุตุฑุงุญุฉ ๐ช', 'ุงูุณุนุฑ ูุนุชุจุฑ ููุชุงุฒ ููุงุฑูุฉ ุจุงูููุงูุณูู', 'ุดูุฑุงู ุนูู ุงููุนูููุงุช ุงููููุฉ ๐'
  ],
  nature: [
    'ุณุจุญุงู ุงูุฎุงูู ๐ฟ', 'ููุธุฑ ูุฑุฏ ุงูุฑูุญ ๐', 'ุชุตููุฑ ุงุญุชุฑุงูู ูุง ุดุงุก ุงููู ๐ธ', 'ุฃุญุชุงุฌ ุฅุฌุงุฒุฉ ูู ููุงู ุฒู ูุฐุง โ๏ธ',
    'ุฌูุงู ุงูุทุจูุนุฉ ูุง ูุถุงูู', 'ุตูุฑุฉ ุชุณุชุญู ุจุฑูุงุฒ ๐ผ๏ธ', 'ุงูุฃููุงู ุฎูุงููุฉ โจ', 'ุฌู ุฎูุงูู โ๏ธ'
  ],
  art: [
    'ุฅุจุฏุงุน ุจูุง ุญุฏูุฏ ๐จ', 'ุงูุฃููุงู ูุชูุงุณูุฉ ุฌุฏุงู ๐', 'ูุฏูู ูููุจุฉ ูุทุฑูุฉ โจ', 'ููุญุฉ ูููุฉ ุฑุงุฆุนุฉ',
    'ุชูุงุตูู ุฏูููุฉ ููุฐููุฉ ๐', 'ูุง ุดุงุก ุงููู ููุงู ๐', 'ุงุณุชูุฑ ูุง ูุจุฏุน ๐', 'ุฐููู ุฑููุน ุฌุฏุงู'
  ],
  sport: [
    'ุนุงุด ุงููุญุด ๐ช', 'ุงุณุชูุฑ ูุง ุจุทู ๐ฅ', 'ุงูููุงูุฉ ุฃุณููุจ ุญูุงุฉ ๐๏ธโโ๏ธ', 'ูุฌููุฏ ุฌุจุงุฑ',
    'ูุง ูู ูุณุชุญูู ๐', 'ุงูููุฉ ูุง ุจุงุฑู ุงููู ูู ุงูุถุนู', 'ูุญุด ุงูุชูุงุฑูู ๐ฆ', 'ุงููุชุงุฆุฌ ุจุฏุฃุช ุชุธูุฑ ุจูุถูุญ ๐'
  ],
  sad: [
    'ูุง ุจุฃุณ ุนูููุ ุบุฏุงู ุฃุฌูู โค๏ธ', 'ูู ูููุงู ๐ช', 'ูููุง ููุฑ ุจุฃูุงู ุตุนุจุฉ', 'ุงููู ููุฑุฌ ููู',
    'ูุชุฑุฉ ูุชุนุฏู ุจุฅุฐู ุงููู', 'ูููุจูุง ูุนู ๐', 'ูุง ุชูุฃุณุ ุงูุฃูู ููุฌูุฏ โจ', 'ููู ุนููู'
  ],
  cars: [
    'ุงูููุชุฑ ููุจุฉ ูุง ุดุงุก ุงููู ๐๏ธ', 'ุงููู ูุนุทูู ุฎูุฑูุง ูููููู ุดุฑูุง', 'ุชุตููู ุงูุณูุงุจู ูุฌููู', 'ูุญุด ุงูุทุฑูู ๐ฅ',
    'ุงูููู ูุฎู ุฌุฏุงู ๐ค', 'ููุฏุณุฉ ุฃููุงููุฉ ููุง ุบูุทุฉ', 'ุทุฑุจ ุงูููููุฉ ๐ต', 'ุญูู ุญูุงุชู ูุฐู ุงูุณูุงุฑุฉ'
  ],
  general: [
    'ููุดูุฑ ุฑุงุฆุน โจ', 'ูุนูุงู ๐', 'ููุงู ูู ุฐูุจ ๐', 'ุฃุญุณูุช ุงููุดุฑ ๐', 'ุงุชูู ูุนู ุชูุงูุงู ๐ฏ', 
    'ูุจุฏุน ูุงูุนุงุฏุฉ ๐', 'ูุนุทูู ุงูุนุงููุฉ', 'ููุดูุฑ ูููุฒ ุฌุฏุงู', 'ูุง ุชุญุฑููุง ูู ุฌุฏูุฏู', 'ุฃุณุทูุฑุฉ! ๐ฅ'
  ],
  question: [
    'ุณุคุงู ูุฌูู ๐ค', 'ุฃุชููุน ุงูุฅุฌุงุจุฉ ุชุนุชูุฏ ุนูู ุงูุดุฎุต', 'ููุถูุน ููููุงุด ููู', 'ุฑุฃูู ุงูุดุฎุตู ูุนู โ',
    'ูุง ุฃุชูู ูุน ูุฐู ุงูููุทุฉ ุชูุงูุงู', 'ูุญุชุงุฌ ุชูุงุตูู ุฃูุซุฑ ููุฅุฌุงุจุฉ', 'ุณุคุงู ุตุนุจ ุตุฑุงุญุฉ ๐', 'ุดุงุฑูููุง ุขุฑุงุฆูู ูุง ุฌูุงุนุฉ'
  ]
};

const POST_TEMPLATES: Record<string, string[]> = {
  'ูุฑุญ': [
    'ุชุฎูููุง ูู ุฃู {topic} ูุงู ูุณููุญุงู ูู ูู ููุงู! ๐ ูุด ุจุชุณููุ',
    'ููุฏู ุงูููู ุนุจุงุฑุฉ ุนู {topic} ููููุฉ โ๏ธโจ',
    'ุจุตุฑุงุญุฉุ {topic} ูู ุณุฑ ุงูุณุนุงุฏุฉ ุงูุญููููุฉ ๐คช',
    'ุฃุญูู ุดู ูู ุงูุฏููุง: {topic}ุ ูู ูุชููุ ๐'
  ],
  'ุฑุณูู': [
    'ูุนุชุจุฑ {topic} ูู ุฃูู ุงูุฑูุงุฆุฒ ุงูุชู ูุฌุจ ุงูุงูุชุจุงู ููุง ูู ุนุตุฑูุง ุงูุญุงูู.',
    'ุฏุฑุงุณุฉ {topic} ุชูุชุญ ุขูุงูุงู ุฌุฏูุฏุฉ ููุชุทููุฑ ูุงูููู ุงููููู. ๐',
    'ูุธุฑุฉ ุชุญููููุฉ ุญูู {topic} ูุชุฃุซูุฑู ุนูู ุงููุฌุชูุน.',
    'ุฎูุงุตุฉ ุชุฌุฑุจุชู ูุน {topic} ูุงููุชุงุฆุฌ ุงูุชู ุชูุตูุช ุฅูููุง.'
  ],
  'ุนููู': [
    'ูู ุนูู {topic} ุชุฌุฏ ุญูุงุฆู ูุง ูุฑุงูุง ุงูุฌููุน... ๐',
    'ุฃุญูุงูุงู ูููู {topic} ูู ุงูุฑุณุงูุฉ ุงูุชู ููุชุธุฑูุง ูู ุงูููู.',
    'ุชุฃููุช ูู {topic} ููุฌุฏุช ููู ุงูุนูุงุณุงู ูุฐูุงุชูุง.',
    '{topic}... ูุฌุฑุฏ ูููุฉุ ููููุง ุชุญูู ูุนุงูู ูุง ุญุตุฑ ููุง.'
  ]
};

const BAD_WORDS = ['ุบุจู', 'ุญููุฑ', 'ููุช', 'ูุชู', 'ุฏู', 'ูุฑู', 'ุนูุตุฑู', 'ุดุชููุฉ'];

// --- Helper Functions ---

const getRandomElement = <T>(arr: T[]): T => arr[Math.floor(Math.random() * arr.length)];

// --- Services Exports ---

export const generateCreativePost = async (topic: string, mood: string): Promise<string> => {
  // ูุญุงูุงุฉ ุชุฃุฎูุฑ ุงูุดุจูุฉ
  await new Promise(resolve => setTimeout(resolve, 800));
  
  const templates = POST_TEMPLATES[mood as keyof typeof POST_TEMPLATES] || POST_TEMPLATES['ูุฑุญ'];
  const template = getRandomElement(templates);
  
  return template.replace(/{topic}/g, topic);
};

export const generateImageDescription = async (idea: string): Promise<string> => {
  await new Promise(resolve => setTimeout(resolve, 500));
  return idea; 
};

export const moderateContent = async (text: string): Promise<{ safe: boolean; reason?: string }> => {
  await new Promise(resolve => setTimeout(resolve, 300));
  
  const hasBadWord = BAD_WORDS.some(word => text.includes(word));
  
  if (hasBadWord) {
    return { 
      safe: false, 
      reason: "ูุญุชูู ุงููุต ุนูู ูููุงุช ุบูุฑ ูุงุฆูุฉ ุชุฎุงูู ุณูุงุณุฉ ุงููุฌุชูุน." 
    };
  }
  
  return { safe: true };
};

// ุงูุฏุงูุฉ ุงูุฃุณุทูุฑูุฉ ูุชูููุฏ ุชุนูููุงุช ุงูุจูุชุงุช
export const generateBotComment = async (postContent: string, personality: string): Promise<string> => {
  // ุชุฃุฎูุฑ ุนุดูุงุฆู ุจุณูุท ุฌุฏุงู ููุญุงูุงุฉ ุงูุชูููุฑ ุงูุจุดุฑู
  // await new Promise(resolve => setTimeout(resolve, 100)); // ุชูุช ุฅุฒุงูุชู ูุณุฑุนุฉ ุงูุฃุฏุงุก ูู ุงูู Batch
  
  const lowerContent = postContent.toLowerCase();
  
  // ุชุญููู ุนููู ูููุญุชูู (Smart Keyword Matching)
  if (lowerContent.match(/ุฃูู|ุทุจุฎ|ูุทุนู|ูุฐูุฐ|ูููุฉ|ุจูุชุฒุง|ุจุฑุฌุฑ|ุญูู|ุฌูุน/)) return getRandomElement(RESPONSES_DB.food);
  if (lowerContent.match(/ุชุทุจูู|ุฌูุงู|ุจุฑูุฌุฉ|ุชุตููู|ููุจููุชุฑ|ูุช|ุงูููู|ุณุงูุณููุฌ|ุฐูุงุก/)) return getRandomElement(RESPONSES_DB.tech);
  if (lowerContent.match(/ุจุญุฑ|ุณูุงุก|ุดุฌุฑ|ูุทุฑ|ุฌุจู|ุทุจูุนุฉ|ุณูุฑ|ุบููู/)) return getRandomElement(RESPONSES_DB.nature);
  if (lowerContent.match(/ุฑุณู|ูู|ุตูุฑุฉ|ุฃููุงู|ููุญุฉ|ุชุตููุฑ|ูุงููุฑุง/)) return getRandomElement(RESPONSES_DB.art);
  if (lowerContent.match(/ุชูุฑูู|ูุงุฏู|ููุฑุฉ|ูุจุงุฑุงุฉ|ููุฒ|ุฌูู|ุนุถูุงุช/)) return getRandomElement(RESPONSES_DB.sport);
  if (lowerContent.match(/ุญุฒูู|ุชุนุจ|ูุฑุถ|ุฃูู|ูุฑุงู|ุถูู|ููุช/)) return getRandomElement(RESPONSES_DB.sad);
  if (lowerContent.match(/ุณูุงุฑุฉ|ููุชุฑ|ุฏุฑูุช|ุณุฑุนุฉ|ูุฑุณูุฏุณ|ุจู ุงู|ุชูููุชุง/)) return getRandomElement(RESPONSES_DB.cars);
  if (lowerContent.match(/ุ|ูุงุฐุง|ููู|ูุชู|ูู|ุฑุฃููู/)) return getRandomElement(RESPONSES_DB.question);

  // ุฑุฏูุฏ ุฎุงุตุฉ ุจุงูู Bot Personality (ุดุฎุตูุฉ ุงูุจูุช)
  if (personality === 'ุฏุงุนู') return 'ุงุณุชูุฑ ูุง ุจุทูุ ูุญุชูุงู ุฑููุจ! ๐ฅ';
  if (personality === 'ูุงูุฏ') return 'ูุฌูุฉ ูุธุฑ ูุซูุฑุฉ ููุงูุชูุงู ๐ค';
  if (personality === 'ูุฑุญ') return 'ูููููู ุฑููุจ ูุงููู ๐';
  
  // ุฅุฐุง ูู ูุทุงุจู ุดูุกุ ุฑุฏ ุนุงู ูุฎู
  return getRandomElement(RESPONSES_DB.general);
};
